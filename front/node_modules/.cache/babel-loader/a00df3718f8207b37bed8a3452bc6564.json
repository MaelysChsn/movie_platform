{"ast":null,"code":"var _jsxFileName = \"/Users/maelyschassin/Desktop/HETIC/Front end/movie_platform/front/src/Components/formLogin.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport useRegister from \"../Hooks/register.tsx\";\nimport useLogin from \"../Hooks/login.tsx\";\nimport { useCookies } from 'react-cookie';\nimport { useDispatch } from \"react-redux\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function FormLogin(_ref) {\n  _s();\n\n  let {} = _ref;\n  const login = useLogin();\n  const register = useRegister();\n  const [cookies, setCookies] = useCookies(['hetic_email', 'hetic_token']);\n  const navigate = useNavigate();\n  const dispatch = useDispatch();\n  const [localUser, setLocalUser] = useState({\n    email: \"\",\n    password: \"\",\n    username: \"\"\n  });\n  const [needsLogin, setNeedsLogin] = useState(true);\n  const [needsUpdate, setNeedsUpdate] = useState(false);\n  const [isCookies, setIsCookies] = useState(false);\n  const [formInput, setFormInput] = useState({\n    email: \"\",\n    password: \"\",\n    username: \"\"\n  });\n\n  const handleCookies = (email, token) => {\n    setCookies('hetic_email', email, {\n      path: '/'\n    });\n    setCookies('hetic_token', token, {\n      path: '/'\n    });\n    setIsCookies(true);\n  };\n\n  useEffect(() => {\n    dispatch(login({\n      email: cookies.hetic_email,\n      token: cookies.hetic_token\n    }));\n    console.log('user', user);\n  }, []);\n  useEffect(() => {\n    if (needsLogin && localUser.email !== '') {\n      console.log('login ?', localUser.email);\n      login(localUser.email, localUser.password, localUser.username).then(data => {\n        if (data.status !== 'error') {\n          handleCookies(data.email, data.token);\n          handleDispatch(data.email, data.token);\n          navigate('/');\n        } else {\n          alert(data.message);\n        }\n      });\n    } else if (!needsLogin && localUser.email !== '') {\n      console.log('register ?', localUser.username);\n      register(localUser.email, localUser.password, localUser.username).then(data => {\n        if (data.status !== 'error') {\n          setNeedsLogin(true);\n          setFormInput({\n            email: \"\",\n            password: \"\",\n            username: \"\"\n          });\n        } else {\n          console.log(data);\n        }\n      });\n    }\n  }, [localUser]);\n\n  const handleChange = _ref2 => {\n    let {\n      target\n    } = _ref2;\n    setFormInput(prev => ({ ...prev,\n      [target.name]: target.value\n    }));\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    setLocalUser(formInput);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"c-container\",\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"mx-auto\",\n      style: {\n        maxWidth: '350px'\n      },\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"mb-3 text-center\",\n        children: needsLogin ? 'Please Log In' : 'Please Register'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 17\n      }, this), !needsLogin ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-floating mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          className: \"form-control\",\n          id: \"floatingInput\",\n          placeholder: \"mama\",\n          name: \"username\",\n          onChange: handleChange,\n          value: formInput.username\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"floatingInput\",\n          children: \"Username\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 21\n      }, this) : null, /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-floating mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          className: \"form-control\",\n          id: \"floatingInput\",\n          placeholder: \"mama@gmail.com\",\n          name: \"email\",\n          onChange: handleChange,\n          value: formInput.email\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"floatingInput\",\n          children: \"Email\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3 form-floating\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          className: \"form-control\",\n          id: \"floatingPassword\",\n          placeholder: \"Password\",\n          name: \"password\",\n          onChange: handleChange,\n          value: formInput.password\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"floatingPassword\",\n          children: \"Password\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-primary w-100\",\n        children: needsLogin ? 'Login' : 'Register'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-warning mt-3 w-100\",\n        onClick: () => setNeedsLogin(!needsLogin),\n        children: [needsLogin ? 'Register' : 'Login', \" instead ?\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 92,\n    columnNumber: 9\n  }, this);\n}\n\n_s(FormLogin, \"yAmHc6pf0jxQomgoxEAMr/WbWUg=\", false, function () {\n  return [useLogin, useRegister, useCookies, useNavigate, useDispatch];\n});\n\n_c = FormLogin;\n\nvar _c;\n\n$RefreshReg$(_c, \"FormLogin\");","map":{"version":3,"names":["React","useState","useEffect","useNavigate","useRegister","useLogin","useCookies","useDispatch","FormLogin","login","register","cookies","setCookies","navigate","dispatch","localUser","setLocalUser","email","password","username","needsLogin","setNeedsLogin","needsUpdate","setNeedsUpdate","isCookies","setIsCookies","formInput","setFormInput","handleCookies","token","path","hetic_email","hetic_token","console","log","user","then","data","status","handleDispatch","alert","message","handleChange","target","prev","name","value","handleSubmit","e","preventDefault","maxWidth"],"sources":["/Users/maelyschassin/Desktop/HETIC/Front end/movie_platform/front/src/Components/formLogin.tsx"],"sourcesContent":["import React, {useState, useEffect} from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport useRegister from \"../Hooks/register.tsx\";\nimport useLogin from \"../Hooks/login.tsx\";\nimport {LocalUserInterface} from \"../Interface/LocalUserInterface\";\nimport {LoginResponseInterface} from \"../Interface/ResponsesInterfaces\";\nimport { useCookies } from 'react-cookie';\nimport {useDispatch} from \"react-redux\";\nimport {login} from \"./redux/userSlice\";\n\n\ninterface LoginFormPropsInterface {\n    setLocalUser: React.Dispatch<LocalUserInterface>,\n    needsLogin: boolean,\n    setNeedsLogin: React.Dispatch<boolean>\n}\n\nexport default function FormLogin({}: LoginFormPropsInterface){\n\n  const login = useLogin();\n  const register = useRegister();\n  const [cookies, setCookies] = useCookies(['hetic_email', 'hetic_token']);\n\n  const navigate = useNavigate();\n  const dispatch = useDispatch();\n\n\n  const [localUser, setLocalUser] = useState<LocalUserInterface>({email: \"\", password: \"\", username: \"\"})\n  const [needsLogin, setNeedsLogin] = useState<boolean>(true)\n  const [needsUpdate, setNeedsUpdate] = useState<boolean>(false)\n  const [isCookies, setIsCookies] = useState<boolean>(false)\n\n  const [formInput, setFormInput] = useState<LocalUserInterface>({email: \"\", password: \"\", username: \"\"})\n\n  const handleCookies = (email, token) => {\n    setCookies('hetic_email', email, { path: '/' });\n    setCookies('hetic_token', token, { path: '/' });\n    setIsCookies(true);\n  };\n\n\n\n  useEffect(() =>{\n     dispatch(login({\n         email: cookies.hetic_email,\n         token: cookies.hetic_token\n     }));\n     console.log('user', user);\n  }, [])\n\n  useEffect(() => {\n        if (needsLogin && localUser.email !== '') {\n            console.log('login ?', localUser.email);\n            login(localUser.email, localUser.password, localUser.username)\n                .then(data => {\n                    if(data.status !== 'error'){\n                      handleCookies(data.email, data.token);\n                      handleDispatch(data.email, data.token);\n                      navigate('/');\n                    }else{\n                      alert(data.message);\n                    }\n                })\n        } else if (!needsLogin && localUser.email !== '') {\n            console.log('register ?', localUser.username)\n            register(localUser.email, localUser.password, localUser.username)\n                .then(data => {\n                  if(data.status !== 'error'){\n                    setNeedsLogin(true);\n                    setFormInput({email: \"\", password: \"\", username: \"\"})\n                  }else{\n                    console.log(data);\n                  }\n                })\n        }\n    }, [localUser])\n\n    const handleChange = ({target}: any) => {\n        setFormInput(prev => ({\n            ...prev,\n            [target.name]: target.value\n        }))\n    }\n\n    const handleSubmit = (e: any) => {\n        e.preventDefault();\n        setLocalUser(formInput);\n    }\n\n\n    return (\n        <div className=\"c-container\">\n            <form className='mx-auto' style={{maxWidth: '350px'}} onSubmit={handleSubmit}>\n                <h2 className='mb-3 text-center'>{needsLogin ? 'Please Log In' : 'Please Register'}</h2>\n                {\n                    !needsLogin ?\n                    <div className=\"form-floating mb-3\">\n                        <input type=\"text\" className=\"form-control\" id=\"floatingInput\" placeholder=\"mama\"\n                               name='username' onChange={handleChange} value={formInput.username}/>\n                        <label htmlFor=\"floatingInput\">Username</label>\n                    </div>\n                    :\n                    null\n                }\n\n                <div className=\"form-floating mb-3\">\n                    <input type=\"text\" className=\"form-control\" id=\"floatingInput\" placeholder=\"mama@gmail.com\"\n                           name='email' onChange={handleChange} value={formInput.email}/>\n                    <label htmlFor=\"floatingInput\">Email</label>\n                </div>\n                <div className=\"mb-3 form-floating\">\n                    <input type=\"password\" className=\"form-control\" id=\"floatingPassword\" placeholder=\"Password\"\n                           name='password' onChange={handleChange} value={formInput.password}/>\n                    <label htmlFor=\"floatingPassword\">Password</label>\n                </div>\n                <button type='submit' className='btn btn-primary w-100'>{needsLogin ? 'Login' : 'Register'}</button>\n                <button className='btn btn-warning mt-3 w-100'\n                        onClick={() => setNeedsLogin(!needsLogin)}>{needsLogin ? 'Register' : 'Login'} instead ?</button>\n            </form>\n        </div>\n    )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}