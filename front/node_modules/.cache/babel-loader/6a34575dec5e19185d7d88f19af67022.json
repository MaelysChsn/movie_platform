{"ast":null,"code":"var _jsxFileName = \"/Users/maelyschassin/Desktop/HETIC/Front end/movie_platform/front/src/Components/formLogin.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport useRegister from \"../Hooks/register.tsx\";\nimport useLogin from \"../Hooks/login.tsx\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function FormLogin(_ref) {\n  _s();\n\n  let {\n    setLoggedUser\n  } = _ref;\n  const login = useLogin();\n  const register = useRegister();\n  const [localUser, setLocalUser] = useState({\n    email: \"\",\n    password: \"\"\n  });\n  const [needsLogin, setNeedsLogin] = useState(true);\n  const [needsUpdate, setNeedsUpdate] = useState(false);\n  const [formInput, setFormInput] = useState({\n    email: \"\",\n    password: \"\"\n  });\n  useEffect(() => {\n    if (needsLogin && localUser.email !== '') {\n      console.log('login ?');\n      login(localUser.email, localUser.password).then(data => {\n        console.log(data);\n        setLoggedUser(data);\n\n        if (data.status !== 'error') {\n          window.location.href = \"http://localhost:3000/\";\n        } else {\n          alert(data.message);\n        }\n      });\n    } else if (!needsLogin && localUser.email !== '') {\n      console.log('register ?', localUser.email);\n      register(localUser.email, localUser.password).then(data => {\n        setLoggedUser(data);\n\n        if (data.status !== 'error') {\n          setNeedsLogin(true);\n          setFormInput({\n            email: \"\",\n            password: \"\"\n          });\n        } else {\n          alert(data.message);\n        }\n      });\n    }\n  }, [localUser]);\n\n  const handleChange = _ref2 => {\n    let {\n      target\n    } = _ref2;\n    setFormInput(prev => ({ ...prev,\n      [target.name]: target.value\n    }));\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    setLocalUser(formInput);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    className: \"mx-auto\",\n    style: {\n      maxWidth: '350px'\n    },\n    onSubmit: handleSubmit,\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"mb-3 text-center\",\n      children: needsLogin ? 'Please Log In' : 'Please Register'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form-floating mb-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        id: \"floatingInput\",\n        placeholder: \"FrancisHuster\",\n        name: \"email\",\n        onChange: handleChange,\n        value: formInput.email\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"floatingInput\",\n        children: \"Email\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-3 form-floating\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"password\",\n        className: \"form-control\",\n        id: \"floatingPassword\",\n        placeholder: \"Password\",\n        name: \"password\",\n        onChange: handleChange,\n        value: formInput.password\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"floatingPassword\",\n        children: \"Password\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      className: \"btn btn-primary w-100\",\n      children: needsLogin ? 'Login' : 'Register'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"btn btn-warning mt-3 w-100\",\n      onClick: () => setNeedsLogin(!needsLogin),\n      children: [needsLogin ? 'Register' : 'Login', \" instead ?\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 9\n  }, this);\n}\n\n_s(FormLogin, \"H1gk8DWVMes7Y8iVB16mzvLZoHs=\", false, function () {\n  return [useLogin, useRegister];\n});\n\n_c = FormLogin;\n\nvar _c;\n\n$RefreshReg$(_c, \"FormLogin\");","map":{"version":3,"names":["React","useState","useEffect","useRegister","useLogin","FormLogin","setLoggedUser","login","register","localUser","setLocalUser","email","password","needsLogin","setNeedsLogin","needsUpdate","setNeedsUpdate","formInput","setFormInput","console","log","then","data","status","window","location","href","alert","message","handleChange","target","prev","name","value","handleSubmit","e","preventDefault","maxWidth"],"sources":["/Users/maelyschassin/Desktop/HETIC/Front end/movie_platform/front/src/Components/formLogin.tsx"],"sourcesContent":["import React, {useState, useEffect} from \"react\"\nimport useCookies from \"../Hooks/getCookies.tsx\";\nimport useRegister from \"../Hooks/register.tsx\";\nimport useLogin from \"../Hooks/login.tsx\";\nimport {LocalUserInterface} from \"../Interface/LocalUserInterface\";\nimport {LoginResponseInterface} from \"../Interface/ResponsesInterfaces\";\n\n\n\n\ninterface LoginFormPropsInterface {\n    setLocalUser: React.Dispatch<LocalUserInterface>,\n    needsLogin: boolean,\n    setNeedsLogin: React.Dispatch<boolean>\n}\n\nexport default function FormLogin({setLoggedUser}: LoginFormPropsInterface){\n\n  const login = useLogin();\n  const register = useRegister();\n\n\n  const [localUser, setLocalUser] = useState<LocalUserInterface>({email: \"\", password: \"\"})\n  const [needsLogin, setNeedsLogin] = useState<boolean>(true)\n  const [needsUpdate, setNeedsUpdate] = useState<boolean>(false)\n\n  const [formInput, setFormInput] = useState<LocalUserInterface>({email: \"\", password: \"\"})\n\n      useEffect(() => {\n            if (needsLogin && localUser.email !== '') {\n                console.log('login ?')\n                login(localUser.email, localUser.password)\n                    .then(data => {\n                      console.log(data);\n                        setLoggedUser(data);\n                        if(data.status !== 'error'){\n                            window.location.href = \"http://localhost:3000/\";\n                        }else{\n                          alert(data.message);\n                        }\n                    })\n            } else if (!needsLogin && localUser.email !== '') {\n                console.log('register ?', localUser.email)\n                register(localUser.email, localUser.password)\n                    .then(data => {\n                      setLoggedUser(data);\n                      if(data.status !== 'error'){\n                        setNeedsLogin(true);\n                        setFormInput({email: \"\", password: \"\"})\n                      }else{\n                        alert(data.message);\n                      }\n                    })\n            }\n        }, [localUser])\n\n\n        const handleChange = ({target}: any) => {\n            setFormInput(prev => ({\n                ...prev,\n                [target.name]: target.value\n            }))\n        }\n\n        const handleSubmit = (e: any) => {\n            e.preventDefault();\n            setLocalUser(formInput);\n        }\n\n\n\n    return (\n        <form className='mx-auto' style={{maxWidth: '350px'}} onSubmit={handleSubmit}>\n            <h2 className='mb-3 text-center'>{needsLogin ? 'Please Log In' : 'Please Register'}</h2>\n            <div className=\"form-floating mb-3\">\n                <input type=\"text\" className=\"form-control\" id=\"floatingInput\" placeholder=\"FrancisHuster\"\n                       name='email' onChange={handleChange} value={formInput.email}/>\n                <label htmlFor=\"floatingInput\">Email</label>\n            </div>\n            <div className=\"mb-3 form-floating\">\n                <input type=\"password\" className=\"form-control\" id=\"floatingPassword\" placeholder=\"Password\"\n                       name='password' onChange={handleChange} value={formInput.password}/>\n                <label htmlFor=\"floatingPassword\">Password</label>\n            </div>\n            <button type='submit' className='btn btn-primary w-100'>{needsLogin ? 'Login' : 'Register'}</button>\n            <button className='btn btn-warning mt-3 w-100'\n                    onClick={() => setNeedsLogin(!needsLogin)}>{needsLogin ? 'Register' : 'Login'} instead ?</button>\n        </form>\n    )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}