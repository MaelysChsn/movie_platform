{"ast":null,"code":"var _jsxFileName = \"/Users/maelyschassin/Desktop/HETIC/Front end/movie_platform/front/src/Components/formLogin.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport useRegister from \"../Hooks/register.tsx\";\nimport useLogin from \"../Hooks/login.tsx\";\nimport { useCookies } from 'react-cookie';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function FormLogin(_ref) {\n  _s();\n\n  let {} = _ref;\n  const login = useLogin();\n  const register = useRegister();\n  const [cookie, setCookie] = useCookies(['hetic_email', 'hetic_token']);\n  const navigate = useNavigate();\n  const cookies = useCookies();\n  const [localUser, setLocalUser] = useState({\n    email: \"\",\n    password: \"\",\n    username: \"\"\n  });\n  const [needsLogin, setNeedsLogin] = useState(true);\n  const [needsUpdate, setNeedsUpdate] = useState(false);\n  const [formInput, setFormInput] = useState({\n    email: \"\",\n    password: \"\",\n    username: \"\"\n  });\n\n  const handleCookies = (email, token) => {\n    setCookie('hetic_email', email, {\n      path: '/'\n    });\n    setCookie('hetic_token', token, {\n      path: '/'\n    });\n    dispatch(login({\n      email: cookies.hetic_email,\n      token: cookies.hetic_token\n    }));\n  };\n\n  useEffect(() => {\n    if (Object.keys(cookies).includes('hetic_token') && Object.keys(cookies).includes('hetic_email')) {\n      console.log('got cookies !');\n      dispatch(login({\n        email: cookies.hetic_email,\n        token: cookies.hetic_token\n      }));\n    }\n  }, [cookie]);\n  useEffect(() => {\n    if (needsLogin && localUser.email !== '') {\n      console.log('login ?', localUser.email);\n      login(localUser.email, localUser.password, localUser.username).then(data => {\n        if (data.status !== 'error') {\n          handleCookies(data.email, data.token);\n          navigate('/');\n        } else {\n          alert(data.message);\n        }\n      });\n    } else if (!needsLogin && localUser.email !== '') {\n      console.log('register ?', localUser.username);\n      register(localUser.email, localUser.password, localUser.username).then(data => {\n        if (data.status !== 'error') {\n          setNeedsLogin(true);\n          setFormInput({\n            email: \"\",\n            password: \"\",\n            username: \"\"\n          });\n        } else {\n          console.log(data);\n        }\n      });\n    }\n  }, [localUser]);\n\n  const handleChange = _ref2 => {\n    let {\n      target\n    } = _ref2;\n    setFormInput(prev => ({ ...prev,\n      [target.name]: target.value\n    }));\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    setLocalUser(formInput);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"c-container\",\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"mx-auto\",\n      style: {\n        maxWidth: '350px'\n      },\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"mb-3 text-center\",\n        children: needsLogin ? 'Please Log In' : 'Please Register'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 17\n      }, this), !needsLogin ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-floating mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          className: \"form-control\",\n          id: \"floatingInput\",\n          placeholder: \"mama\",\n          name: \"username\",\n          onChange: handleChange,\n          value: formInput.username\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"floatingInput\",\n          children: \"Username\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 21\n      }, this) : null, /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-floating mb-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          className: \"form-control\",\n          id: \"floatingInput\",\n          placeholder: \"mama@gmail.com\",\n          name: \"email\",\n          onChange: handleChange,\n          value: formInput.email\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"floatingInput\",\n          children: \"Email\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-3 form-floating\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          className: \"form-control\",\n          id: \"floatingPassword\",\n          placeholder: \"Password\",\n          name: \"password\",\n          onChange: handleChange,\n          value: formInput.password\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"floatingPassword\",\n          children: \"Password\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-primary w-100\",\n        children: needsLogin ? 'Login' : 'Register'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-warning mt-3 w-100\",\n        onClick: () => setNeedsLogin(!needsLogin),\n        children: [needsLogin ? 'Register' : 'Login', \" instead ?\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 92,\n    columnNumber: 9\n  }, this);\n}\n\n_s(FormLogin, \"cd9oFkN86SD+gtsvKc2KjRbBclI=\", false, function () {\n  return [useLogin, useRegister, useCookies, useNavigate, useCookies];\n});\n\n_c = FormLogin;\n\nvar _c;\n\n$RefreshReg$(_c, \"FormLogin\");","map":{"version":3,"names":["React","useState","useEffect","useNavigate","useRegister","useLogin","useCookies","FormLogin","login","register","cookie","setCookie","navigate","cookies","localUser","setLocalUser","email","password","username","needsLogin","setNeedsLogin","needsUpdate","setNeedsUpdate","formInput","setFormInput","handleCookies","token","path","dispatch","hetic_email","hetic_token","Object","keys","includes","console","log","then","data","status","alert","message","handleChange","target","prev","name","value","handleSubmit","e","preventDefault","maxWidth"],"sources":["/Users/maelyschassin/Desktop/HETIC/Front end/movie_platform/front/src/Components/formLogin.tsx"],"sourcesContent":["import React, {useState, useEffect} from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport useRegister from \"../Hooks/register.tsx\";\nimport useLogin from \"../Hooks/login.tsx\";\nimport {LocalUserInterface} from \"../Interface/LocalUserInterface\";\nimport {LoginResponseInterface} from \"../Interface/ResponsesInterfaces\";\nimport { useCookies } from 'react-cookie';\nimport {useDispatch} from \"react-redux\";\nimport {login} from \"./redux/userSlice\";\n\n\ninterface LoginFormPropsInterface {\n    setLocalUser: React.Dispatch<LocalUserInterface>,\n    needsLogin: boolean,\n    setNeedsLogin: React.Dispatch<boolean>\n}\n\nexport default function FormLogin({}: LoginFormPropsInterface){\n\n  const login = useLogin();\n  const register = useRegister();\n  const [cookie, setCookie] = useCookies(['hetic_email', 'hetic_token']);\n\n  const navigate = useNavigate();\n  const cookies = useCookies();\n\n  const [localUser, setLocalUser] = useState<LocalUserInterface>({email: \"\", password: \"\", username: \"\"})\n  const [needsLogin, setNeedsLogin] = useState<boolean>(true)\n  const [needsUpdate, setNeedsUpdate] = useState<boolean>(false)\n\n  const [formInput, setFormInput] = useState<LocalUserInterface>({email: \"\", password: \"\", username: \"\"})\n\n  const handleCookies = (email, token) => {\n    setCookie('hetic_email', email, { path: '/' });\n    setCookie('hetic_token', token, { path: '/' });\n    dispatch(login({\n      email: cookies.hetic_email,\n      token: cookies.hetic_token,\n    }));\n  };\n\n  useEffect(() => {\n       if (Object.keys(cookies).includes('hetic_token') && Object.keys(cookies).includes('hetic_email')) {\n           console.log('got cookies !')\n           dispatch(login({\n             email: cookies.hetic_email,\n             token: cookies.hetic_token,\n           }));\n        }\n    }, [cookie])\n\n  useEffect(() => {\n        if (needsLogin && localUser.email !== '') {\n            console.log('login ?', localUser.email);\n            login(localUser.email, localUser.password, localUser.username)\n                .then(data => {\n                    if(data.status !== 'error'){\n                      handleCookies(data.email, data.token);\n                      navigate('/');\n                    }else{\n                      alert(data.message);\n                    }\n                })\n        } else if (!needsLogin && localUser.email !== '') {\n            console.log('register ?', localUser.username)\n            register(localUser.email, localUser.password, localUser.username)\n                .then(data => {\n                  if(data.status !== 'error'){\n                    setNeedsLogin(true);\n                    setFormInput({email: \"\", password: \"\", username: \"\"})\n                  }else{\n                    console.log(data);\n                  }\n                })\n        }\n    }, [localUser])\n\n    const handleChange = ({target}: any) => {\n        setFormInput(prev => ({\n            ...prev,\n            [target.name]: target.value\n        }))\n    }\n\n    const handleSubmit = (e: any) => {\n        e.preventDefault();\n        setLocalUser(formInput);\n    }\n\n\n    return (\n        <div className=\"c-container\">\n            <form className='mx-auto' style={{maxWidth: '350px'}} onSubmit={handleSubmit}>\n                <h2 className='mb-3 text-center'>{needsLogin ? 'Please Log In' : 'Please Register'}</h2>\n                {\n                    !needsLogin ?\n                    <div className=\"form-floating mb-3\">\n                        <input type=\"text\" className=\"form-control\" id=\"floatingInput\" placeholder=\"mama\"\n                               name='username' onChange={handleChange} value={formInput.username}/>\n                        <label htmlFor=\"floatingInput\">Username</label>\n                    </div>\n                    :\n                    null\n                }\n\n                <div className=\"form-floating mb-3\">\n                    <input type=\"text\" className=\"form-control\" id=\"floatingInput\" placeholder=\"mama@gmail.com\"\n                           name='email' onChange={handleChange} value={formInput.email}/>\n                    <label htmlFor=\"floatingInput\">Email</label>\n                </div>\n                <div className=\"mb-3 form-floating\">\n                    <input type=\"password\" className=\"form-control\" id=\"floatingPassword\" placeholder=\"Password\"\n                           name='password' onChange={handleChange} value={formInput.password}/>\n                    <label htmlFor=\"floatingPassword\">Password</label>\n                </div>\n                <button type='submit' className='btn btn-primary w-100'>{needsLogin ? 'Login' : 'Register'}</button>\n                <button className='btn btn-warning mt-3 w-100'\n                        onClick={() => setNeedsLogin(!needsLogin)}>{needsLogin ? 'Register' : 'Login'} instead ?</button>\n            </form>\n        </div>\n    )\n}\n"],"mappings":";;;AAAA,OAAOA,KAAP,IAAeC,QAAf,EAAyBC,SAAzB,QAAyC,OAAzC;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,OAAOC,WAAP,MAAwB,uBAAxB;AACA,OAAOC,QAAP,MAAqB,oBAArB;AAGA,SAASC,UAAT,QAA2B,cAA3B;;AAWA,eAAe,SAASC,SAAT,OAA+C;EAAA;;EAAA,IAA5B,EAA4B;EAE5D,MAAMC,KAAK,GAAGH,QAAQ,EAAtB;EACA,MAAMI,QAAQ,GAAGL,WAAW,EAA5B;EACA,MAAM,CAACM,MAAD,EAASC,SAAT,IAAsBL,UAAU,CAAC,CAAC,aAAD,EAAgB,aAAhB,CAAD,CAAtC;EAEA,MAAMM,QAAQ,GAAGT,WAAW,EAA5B;EACA,MAAMU,OAAO,GAAGP,UAAU,EAA1B;EAEA,MAAM,CAACQ,SAAD,EAAYC,YAAZ,IAA4Bd,QAAQ,CAAqB;IAACe,KAAK,EAAE,EAAR;IAAYC,QAAQ,EAAE,EAAtB;IAA0BC,QAAQ,EAAE;EAApC,CAArB,CAA1C;EACA,MAAM,CAACC,UAAD,EAAaC,aAAb,IAA8BnB,QAAQ,CAAU,IAAV,CAA5C;EACA,MAAM,CAACoB,WAAD,EAAcC,cAAd,IAAgCrB,QAAQ,CAAU,KAAV,CAA9C;EAEA,MAAM,CAACsB,SAAD,EAAYC,YAAZ,IAA4BvB,QAAQ,CAAqB;IAACe,KAAK,EAAE,EAAR;IAAYC,QAAQ,EAAE,EAAtB;IAA0BC,QAAQ,EAAE;EAApC,CAArB,CAA1C;;EAEA,MAAMO,aAAa,GAAG,CAACT,KAAD,EAAQU,KAAR,KAAkB;IACtCf,SAAS,CAAC,aAAD,EAAgBK,KAAhB,EAAuB;MAAEW,IAAI,EAAE;IAAR,CAAvB,CAAT;IACAhB,SAAS,CAAC,aAAD,EAAgBe,KAAhB,EAAuB;MAAEC,IAAI,EAAE;IAAR,CAAvB,CAAT;IACAC,QAAQ,CAACpB,KAAK,CAAC;MACbQ,KAAK,EAAEH,OAAO,CAACgB,WADF;MAEbH,KAAK,EAAEb,OAAO,CAACiB;IAFF,CAAD,CAAN,CAAR;EAID,CAPD;;EASA5B,SAAS,CAAC,MAAM;IACX,IAAI6B,MAAM,CAACC,IAAP,CAAYnB,OAAZ,EAAqBoB,QAArB,CAA8B,aAA9B,KAAgDF,MAAM,CAACC,IAAP,CAAYnB,OAAZ,EAAqBoB,QAArB,CAA8B,aAA9B,CAApD,EAAkG;MAC9FC,OAAO,CAACC,GAAR,CAAY,eAAZ;MACAP,QAAQ,CAACpB,KAAK,CAAC;QACbQ,KAAK,EAAEH,OAAO,CAACgB,WADF;QAEbH,KAAK,EAAEb,OAAO,CAACiB;MAFF,CAAD,CAAN,CAAR;IAIF;EACJ,CARM,EAQJ,CAACpB,MAAD,CARI,CAAT;EAUAR,SAAS,CAAC,MAAM;IACV,IAAIiB,UAAU,IAAIL,SAAS,CAACE,KAAV,KAAoB,EAAtC,EAA0C;MACtCkB,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAuBrB,SAAS,CAACE,KAAjC;MACAR,KAAK,CAACM,SAAS,CAACE,KAAX,EAAkBF,SAAS,CAACG,QAA5B,EAAsCH,SAAS,CAACI,QAAhD,CAAL,CACKkB,IADL,CACUC,IAAI,IAAI;QACV,IAAGA,IAAI,CAACC,MAAL,KAAgB,OAAnB,EAA2B;UACzBb,aAAa,CAACY,IAAI,CAACrB,KAAN,EAAaqB,IAAI,CAACX,KAAlB,CAAb;UACAd,QAAQ,CAAC,GAAD,CAAR;QACD,CAHD,MAGK;UACH2B,KAAK,CAACF,IAAI,CAACG,OAAN,CAAL;QACD;MACJ,CARL;IASH,CAXD,MAWO,IAAI,CAACrB,UAAD,IAAeL,SAAS,CAACE,KAAV,KAAoB,EAAvC,EAA2C;MAC9CkB,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0BrB,SAAS,CAACI,QAApC;MACAT,QAAQ,CAACK,SAAS,CAACE,KAAX,EAAkBF,SAAS,CAACG,QAA5B,EAAsCH,SAAS,CAACI,QAAhD,CAAR,CACKkB,IADL,CACUC,IAAI,IAAI;QACZ,IAAGA,IAAI,CAACC,MAAL,KAAgB,OAAnB,EAA2B;UACzBlB,aAAa,CAAC,IAAD,CAAb;UACAI,YAAY,CAAC;YAACR,KAAK,EAAE,EAAR;YAAYC,QAAQ,EAAE,EAAtB;YAA0BC,QAAQ,EAAE;UAApC,CAAD,CAAZ;QACD,CAHD,MAGK;UACHgB,OAAO,CAACC,GAAR,CAAYE,IAAZ;QACD;MACF,CARL;IASH;EACJ,CAxBM,EAwBJ,CAACvB,SAAD,CAxBI,CAAT;;EA0BE,MAAM2B,YAAY,GAAG,SAAmB;IAAA,IAAlB;MAACC;IAAD,CAAkB;IACpClB,YAAY,CAACmB,IAAI,KAAK,EAClB,GAAGA,IADe;MAElB,CAACD,MAAM,CAACE,IAAR,GAAeF,MAAM,CAACG;IAFJ,CAAL,CAAL,CAAZ;EAIH,CALD;;EAOA,MAAMC,YAAY,GAAIC,CAAD,IAAY;IAC7BA,CAAC,CAACC,cAAF;IACAjC,YAAY,CAACQ,SAAD,CAAZ;EACH,CAHD;;EAMA,oBACI;IAAK,SAAS,EAAC,aAAf;IAAA,uBACI;MAAM,SAAS,EAAC,SAAhB;MAA0B,KAAK,EAAE;QAAC0B,QAAQ,EAAE;MAAX,CAAjC;MAAsD,QAAQ,EAAEH,YAAhE;MAAA,wBACI;QAAI,SAAS,EAAC,kBAAd;QAAA,UAAkC3B,UAAU,GAAG,eAAH,GAAqB;MAAjE;QAAA;QAAA;QAAA;MAAA,QADJ,EAGQ,CAACA,UAAD,gBACA;QAAK,SAAS,EAAC,oBAAf;QAAA,wBACI;UAAO,IAAI,EAAC,MAAZ;UAAmB,SAAS,EAAC,cAA7B;UAA4C,EAAE,EAAC,eAA/C;UAA+D,WAAW,EAAC,MAA3E;UACO,IAAI,EAAC,UADZ;UACuB,QAAQ,EAAEsB,YADjC;UAC+C,KAAK,EAAElB,SAAS,CAACL;QADhE;UAAA;UAAA;UAAA;QAAA,QADJ,eAGI;UAAO,OAAO,EAAC,eAAf;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA,QAHJ;MAAA;QAAA;QAAA;QAAA;MAAA,QADA,GAOA,IAVR,eAaI;QAAK,SAAS,EAAC,oBAAf;QAAA,wBACI;UAAO,IAAI,EAAC,MAAZ;UAAmB,SAAS,EAAC,cAA7B;UAA4C,EAAE,EAAC,eAA/C;UAA+D,WAAW,EAAC,gBAA3E;UACO,IAAI,EAAC,OADZ;UACoB,QAAQ,EAAEuB,YAD9B;UAC4C,KAAK,EAAElB,SAAS,CAACP;QAD7D;UAAA;UAAA;UAAA;QAAA,QADJ,eAGI;UAAO,OAAO,EAAC,eAAf;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA,QAHJ;MAAA;QAAA;QAAA;QAAA;MAAA,QAbJ,eAkBI;QAAK,SAAS,EAAC,oBAAf;QAAA,wBACI;UAAO,IAAI,EAAC,UAAZ;UAAuB,SAAS,EAAC,cAAjC;UAAgD,EAAE,EAAC,kBAAnD;UAAsE,WAAW,EAAC,UAAlF;UACO,IAAI,EAAC,UADZ;UACuB,QAAQ,EAAEyB,YADjC;UAC+C,KAAK,EAAElB,SAAS,CAACN;QADhE;UAAA;UAAA;UAAA;QAAA,QADJ,eAGI;UAAO,OAAO,EAAC,kBAAf;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA,QAHJ;MAAA;QAAA;QAAA;QAAA;MAAA,QAlBJ,eAuBI;QAAQ,IAAI,EAAC,QAAb;QAAsB,SAAS,EAAC,uBAAhC;QAAA,UAAyDE,UAAU,GAAG,OAAH,GAAa;MAAhF;QAAA;QAAA;QAAA;MAAA,QAvBJ,eAwBI;QAAQ,SAAS,EAAC,4BAAlB;QACQ,OAAO,EAAE,MAAMC,aAAa,CAAC,CAACD,UAAF,CADpC;QAAA,WACoDA,UAAU,GAAG,UAAH,GAAgB,OAD9E;MAAA;QAAA;QAAA;QAAA;MAAA,QAxBJ;IAAA;MAAA;MAAA;MAAA;IAAA;EADJ;IAAA;IAAA;IAAA;EAAA,QADJ;AA+BH;;GAxGuBZ,S;UAERF,Q,EACGD,W,EACWE,U,EAEXH,W,EACDG,U;;;KAPMC,S"},"metadata":{},"sourceType":"module"}