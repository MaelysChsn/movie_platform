{"ast":null,"code":"var _jsxFileName = \"/Users/maelyschassin/Desktop/HETIC/Front end/imdb_app/front/src/Components/formLogin.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport useGetCookies from \"../Hooks/getCookies.tsx\";\nimport useRegister from \"../Hooks/register.tsx\";\nimport useLogin from \"../Hooks/login.tsx\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function FormLogin(LoginFormPropsInterface) {\n  _s();\n\n  const login = useLogin();\n  const register = useRegister();\n  const cookies = useGetCookies();\n  const eraseCookie = useEraseCookie();\n  const [loggedUser, setLoggedUser] = useState({\n    status: 'error',\n    token: \"\",\n    email: \"\"\n  });\n  const [localUser, setLocalUser] = useState({\n    password: \"\",\n    email: \"\"\n  });\n  const [needsLogin, setNeedsLogin] = useState(true);\n  const [needsUpdate, setNeedsUpdate] = useState(false);\n  const [formInput, setFormInput] = useState({\n    password: \"\",\n    email: \"\"\n  });\n\n  const handleChange = _ref => {\n    let {\n      target\n    } = _ref;\n    setFormInput(prev => ({ ...prev,\n      [target.name]: target.value\n    }));\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    setLocalUser(formInput);\n  };\n\n  useEffect(() => {\n    if (Object.keys(cookies).includes('hetic_token') && Object.keys(cookies).includes('hetic_username')) {\n      console.log('got cookies !', loggedUser);\n      setLoggedUser(prev => ({ ...prev,\n        email: cookies.hetic_email,\n        token: cookies.hetic_token\n      }));\n    }\n  }, []);\n  useEffect(() => {\n    if (needsLogin && localUser.email !== '') {\n      console.log('login ?');\n      login(localUser.email, localUser.password).then(data => setLoggedUser(data));\n    } else if (!needsLogin && localUser.email !== '') {\n      console.log('register ?', localUser.email);\n      register(localUser.email, localUser.password).then(data => setLoggedUser(data));\n    }\n  }, [localUser]);\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    className: \"mx-auto\",\n    style: {\n      maxWidth: '350px'\n    },\n    onSubmit: handleSubmit,\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"mb-3 text-center\",\n      children: needsLogin ? 'Please Log In' : 'Please Register'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form-floating mb-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        id: \"floatingInput\",\n        placeholder: \"FrancisHuster\",\n        name: \"email\",\n        onChange: handleChange,\n        value: formInput.email\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"floatingInput\",\n        children: \"Email\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-3 form-floating\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"password\",\n        className: \"form-control\",\n        id: \"floatingPassword\",\n        placeholder: \"Password\",\n        name: \"password\",\n        onChange: handleChange,\n        value: formInput.password\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"floatingPassword\",\n        children: \"Password\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      className: \"btn btn-primary w-100\",\n      children: needsLogin ? 'Login' : 'Register'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"btn btn-warning mt-3 w-100\",\n      onClick: () => setNeedsLogin(!needsLogin),\n      children: [needsLogin ? 'Register' : 'Login', \" instead ?\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 9\n  }, this);\n}\n\n_s(FormLogin, \"Bq3YjAvHm/A9rqHBLT01ff7t9s4=\", true, function () {\n  return [useLogin, useRegister, useGetCookies];\n});\n\n_c = FormLogin;\n\nvar _c;\n\n$RefreshReg$(_c, \"FormLogin\");","map":{"version":3,"names":["React","useState","useGetCookies","useRegister","useLogin","FormLogin","LoginFormPropsInterface","login","register","cookies","eraseCookie","useEraseCookie","loggedUser","setLoggedUser","status","token","email","localUser","setLocalUser","password","needsLogin","setNeedsLogin","needsUpdate","setNeedsUpdate","formInput","setFormInput","handleChange","target","prev","name","value","handleSubmit","e","preventDefault","useEffect","Object","keys","includes","console","log","hetic_email","hetic_token","then","data","maxWidth"],"sources":["/Users/maelyschassin/Desktop/HETIC/Front end/imdb_app/front/src/Components/formLogin.tsx"],"sourcesContent":["import React, {useState} from \"react\"\nimport useGetCookies from \"../Hooks/getCookies.tsx\";\nimport useRegister from \"../Hooks/register.tsx\";\nimport useLogin from \"../Hooks/login.tsx\";\nimport {LocalUserInterface} from \"../Interface/LocalUserInterface\";\nimport {LoginResponseInterface} from \"./Interface/ResponsesInterfaces\";\n\ninterface LoginFormPropsInterface {\n    setLocalUser: React.Dispatch<LocalUserInterface>,\n    needsLogin: boolean,\n    setNeedsLogin: React.Dispatch<boolean>\n}\n\nexport default function FormLogin(LoginFormPropsInterface){\n\n  const login = useLogin();\n  const register = useRegister();\n  const cookies = useGetCookies();\n  const eraseCookie = useEraseCookie();\n\n  const [loggedUser, setLoggedUser] = useState<LoginResponseInterface>({\n        status: 'error',\n        token: \"\",\n        email: \"\"\n  })\n\n  const [localUser, setLocalUser] = useState<LocalUserInterface>({password: \"\", email: \"\"})\n  const [needsLogin, setNeedsLogin] = useState<boolean>(true)\n  const [needsUpdate, setNeedsUpdate] = useState<boolean>(false)\n\n  const [formInput, setFormInput] = useState<LocalUserInterface>({password: \"\", email: \"\"})\n\n    const handleChange = ({target}: any) => {\n        setFormInput(prev => ({\n            ...prev,\n            [target.name]: target.value\n        }))\n    }\n\n    const handleSubmit = (e: any) => {\n        e.preventDefault();\n        setLocalUser(formInput);\n    }\n\n    useEffect(() => {\n          if (Object.keys(cookies).includes('hetic_token') && Object.keys(cookies).includes('hetic_username')) {\n              console.log('got cookies !', loggedUser)\n              setLoggedUser(prev => ({\n                  ...prev,\n                  email: cookies.hetic_email,\n                  token: cookies.hetic_token\n              }))\n          }\n      }, [])\n\n      useEffect(() => {\n            if (needsLogin && localUser.email !== '') {\n                console.log('login ?')\n                login(localUser.email, localUser.password)\n                    .then(data => setLoggedUser(data))\n            } else if (!needsLogin && localUser.email !== '') {\n                console.log('register ?', localUser.email)\n                register(localUser.email, localUser.password)\n                    .then(data => setLoggedUser(data))\n            }\n        }, [localUser])\n\n    return (\n        <form className='mx-auto' style={{maxWidth: '350px'}} onSubmit={handleSubmit}>\n            <h2 className='mb-3 text-center'>{needsLogin ? 'Please Log In' : 'Please Register'}</h2>\n            <div className=\"form-floating mb-3\">\n                <input type=\"text\" className=\"form-control\" id=\"floatingInput\" placeholder=\"FrancisHuster\"\n                       name='email' onChange={handleChange} value={formInput.email}/>\n                <label htmlFor=\"floatingInput\">Email</label>\n            </div>\n            <div className=\"mb-3 form-floating\">\n                <input type=\"password\" className=\"form-control\" id=\"floatingPassword\" placeholder=\"Password\"\n                       name='password' onChange={handleChange} value={formInput.password}/>\n                <label htmlFor=\"floatingPassword\">Password</label>\n            </div>\n            <button type='submit' className='btn btn-primary w-100'>{needsLogin ? 'Login' : 'Register'}</button>\n            <button className='btn btn-warning mt-3 w-100'\n                    onClick={() => setNeedsLogin(!needsLogin)}>{needsLogin ? 'Register' : 'Login'} instead ?</button>\n        </form>\n    )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}