{"ast":null,"code":"var _jsxFileName = \"/Users/maelyschassin/Desktop/HETIC/Front end/imdb_app/front/src/Components/formLogin.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport useCookies from \"../Hooks/getCookies.tsx\";\nimport useRegister from \"../Hooks/register.tsx\";\nimport useLogin from \"../Hooks/login.tsx\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function FormLogin(LoginFormPropsInterface) {\n  _s();\n\n  const login = useLogin();\n  const register = useRegister();\n  const cookies = useCookies();\n  const [loggedUser, setLoggedUser] = useState({\n    status: 'error',\n    token: \"\",\n    email: \"\"\n  });\n  const [localUser, setLocalUser] = useState({\n    email: \"\",\n    password: \"\"\n  });\n  const [needsLogin, setNeedsLogin] = useState(true);\n  const [needsUpdate, setNeedsUpdate] = useState(false);\n  const [formInput, setFormInput] = useState({\n    email: \"\",\n    password: \"\"\n  });\n  useEffect(() => {\n    console.log(\"cookies\", cookies);\n\n    if (Object.keys(cookies).includes('hetic_token') && Object.keys(cookies).includes('hetic_email')) {\n      console.log('got cookies !', loggedUser);\n      setLoggedUser(prev => ({ ...prev,\n        email: cookies.hetic_email,\n        token: cookies.hetic_token\n      }));\n    }\n  }, [loggedUser]);\n  useEffect(() => {\n    if (needsLogin && localUser.email !== '') {\n      console.log('login ?');\n      login(localUser.email, localUser.password).then(data => {\n        console.log(data);\n        setLoggedUser(data);\n\n        if (data.status !== 'error') {//window.location.href = \"http://localhost:3001/\"\n        } else {\n          alert(data.message);\n        }\n      });\n    } else if (!needsLogin && localUser.email !== '') {\n      console.log('register ?', localUser.email);\n      register(localUser.email, localUser.password).then(data => {\n        setLoggedUser(data);\n        console.log(data);\n\n        if (data.status !== 'error') {\n          setNeedsLogin(true);\n          setFormInput({\n            email: \"\",\n            password: \"\"\n          });\n        } else {\n          alert(data.message);\n        }\n      });\n    }\n  }, [localUser]);\n\n  const handleChange = _ref => {\n    let {\n      target\n    } = _ref;\n    setFormInput(prev => ({ ...prev,\n      [target.name]: target.value\n    }));\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    setLocalUser(formInput);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    className: \"mx-auto\",\n    style: {\n      maxWidth: '350px'\n    },\n    onSubmit: handleSubmit,\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"mb-3 text-center\",\n      children: needsLogin ? 'Please Log In' : 'Please Register'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"form-floating mb-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        id: \"floatingInput\",\n        placeholder: \"FrancisHuster\",\n        name: \"email\",\n        onChange: handleChange,\n        value: formInput.email\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"floatingInput\",\n        children: \"Email\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-3 form-floating\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"password\",\n        className: \"form-control\",\n        id: \"floatingPassword\",\n        placeholder: \"Password\",\n        name: \"password\",\n        onChange: handleChange,\n        value: formInput.password\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"floatingPassword\",\n        children: \"Password\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      className: \"btn btn-primary w-100\",\n      children: needsLogin ? 'Login' : 'Register'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"btn btn-warning mt-3 w-100\",\n      onClick: () => setNeedsLogin(!needsLogin),\n      children: [needsLogin ? 'Register' : 'Login', \" instead ?\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 9\n  }, this);\n}\n\n_s(FormLogin, \"toQh56mIjkynt0OcSlLjn4Hot1s=\", false, function () {\n  return [useLogin, useRegister, useCookies];\n});\n\n_c = FormLogin;\n\nvar _c;\n\n$RefreshReg$(_c, \"FormLogin\");","map":{"version":3,"names":["React","useState","useEffect","useCookies","useRegister","useLogin","FormLogin","LoginFormPropsInterface","login","register","cookies","loggedUser","setLoggedUser","status","token","email","localUser","setLocalUser","password","needsLogin","setNeedsLogin","needsUpdate","setNeedsUpdate","formInput","setFormInput","console","log","Object","keys","includes","prev","hetic_email","hetic_token","then","data","alert","message","handleChange","target","name","value","handleSubmit","e","preventDefault","maxWidth"],"sources":["/Users/maelyschassin/Desktop/HETIC/Front end/imdb_app/front/src/Components/formLogin.tsx"],"sourcesContent":["import React, {useState, useEffect} from \"react\"\nimport useCookies from \"../Hooks/getCookies.tsx\";\nimport useRegister from \"../Hooks/register.tsx\";\nimport useLogin from \"../Hooks/login.tsx\";\nimport {LocalUserInterface} from \"../Interface/LocalUserInterface\";\nimport {LoginResponseInterface} from \"../Interface/ResponsesInterfaces\";\n\n\n\n\ninterface LoginFormPropsInterface {\n    setLocalUser: React.Dispatch<LocalUserInterface>,\n    needsLogin: boolean,\n    setNeedsLogin: React.Dispatch<boolean>\n}\n\nexport default function FormLogin(LoginFormPropsInterface){\n\n  const login = useLogin();\n  const register = useRegister();\n  const cookies = useCookies();\n\n\n\n  const [loggedUser, setLoggedUser] = useState<LoginResponseInterface>({\n        status: 'error',\n        token: \"\",\n        email: \"\"\n  })\n\n  const [localUser, setLocalUser] = useState<LocalUserInterface>({email: \"\", password: \"\"})\n  const [needsLogin, setNeedsLogin] = useState<boolean>(true)\n  const [needsUpdate, setNeedsUpdate] = useState<boolean>(false)\n\n  const [formInput, setFormInput] = useState<LocalUserInterface>({email: \"\", password: \"\"})\n\n    useEffect(() => {\n      console.log(\"cookies\", cookies);\n          if (Object.keys(cookies).includes('hetic_token') && Object.keys(cookies).includes('hetic_email')) {\n              console.log('got cookies !', loggedUser)\n              setLoggedUser(prev => ({\n                  ...prev,\n                  email: cookies.hetic_email,\n                  token: cookies.hetic_token\n              }))\n          }\n      }, [loggedUser])\n\n      useEffect(() => {\n\n            if (needsLogin && localUser.email !== '') {\n                console.log('login ?')\n                login(localUser.email, localUser.password)\n                    .then(data => {\n                      console.log(data);\n                        setLoggedUser(data);\n                        if(data.status !== 'error'){\n                          //window.location.href = \"http://localhost:3001/\"\n                        }else{\n                          alert(data.message);\n                        }\n                    })\n            } else if (!needsLogin && localUser.email !== '') {\n                console.log('register ?', localUser.email)\n                register(localUser.email, localUser.password)\n                    .then(data => {\n                      setLoggedUser(data);\n                      console.log(data);\n                      if(data.status !== 'error'){\n                        setNeedsLogin(true);\n                        setFormInput({email: \"\", password: \"\"})\n                      }else{\n                        alert(data.message);\n                      }\n\n                    })\n            }\n        }, [localUser])\n\n\n        const handleChange = ({target}: any) => {\n            setFormInput(prev => ({\n                ...prev,\n                [target.name]: target.value\n            }))\n        }\n\n        const handleSubmit = (e: any) => {\n            e.preventDefault();\n            setLocalUser(formInput);\n        }\n\n\n\n    return (\n        <form className='mx-auto' style={{maxWidth: '350px'}} onSubmit={handleSubmit}>\n            <h2 className='mb-3 text-center'>{needsLogin ? 'Please Log In' : 'Please Register'}</h2>\n            <div className=\"form-floating mb-3\">\n                <input type=\"text\" className=\"form-control\" id=\"floatingInput\" placeholder=\"FrancisHuster\"\n                       name='email' onChange={handleChange} value={formInput.email}/>\n                <label htmlFor=\"floatingInput\">Email</label>\n            </div>\n            <div className=\"mb-3 form-floating\">\n                <input type=\"password\" className=\"form-control\" id=\"floatingPassword\" placeholder=\"Password\"\n                       name='password' onChange={handleChange} value={formInput.password}/>\n                <label htmlFor=\"floatingPassword\">Password</label>\n            </div>\n            <button type='submit' className='btn btn-primary w-100'>{needsLogin ? 'Login' : 'Register'}</button>\n            <button className='btn btn-warning mt-3 w-100'\n                    onClick={() => setNeedsLogin(!needsLogin)}>{needsLogin ? 'Register' : 'Login'} instead ?</button>\n        </form>\n    )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}